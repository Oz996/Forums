(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{3089:function(e,t,r){Promise.resolve().then(r.bind(r,5667))},5667:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Login}});var n=r(7437),s=r(8740),o=r(667),l=r(1396),a=r.n(l),i=r(1865),u=r(3800),c=r(9222),m=r(1349),d=r(4033),x=r(7415),f=r(2265),h=r(4001),components_LoginForm=()=>{let[e,t]=(0,f.useState)(!1),{handleLogin:r,isAuthenticated:l}=(0,m.a)(),g=(0,d.useRouter)();(0,f.useEffect)(()=>{l&&g.push("/")},[l,g]);let{register:p,handleSubmit:j,formState:{errors:S},getValues:b}=(0,i.cI)({email:"",password:""}),loginMutation=async e=>{t(!0);let r=await c.Z.post("https://forums-api.onrender.com/users/login",e);return r.data},w=(0,h.D)(loginMutation,{onSuccess:e=>{t(!1);let n=e.token,s=b("email");r(s,n),x.Am.success("Signed in"),g.push("/")},onError:e=>{t(!1),console.error(e)}});return(0,n.jsxs)("div",{className:"mx-auto max-w-[30rem] mt-10 rounded-xl border shadow-lg p-10 flex flex-col gap-10",children:[(0,n.jsx)("h1",{className:"text-center font-semibold text-xl",children:"Sign in"}),(0,n.jsxs)("form",{className:"flex flex-col gap-5",onSubmit:j(e=>{w.mutate(e)}),children:[(0,n.jsx)(s.Y,{...p("email",{required:"This field is required"}),type:"email",label:"Email"}),(0,n.jsx)(u.B,{errors:S,name:"email",render:e=>{let{message:t}=e;return(0,n.jsx)("p",{className:"text-red-500 text-sm font-semibold",children:t})}}),(0,n.jsx)(s.Y,{...p("password",{required:"This field is required"}),type:"password",label:"Password"}),(0,n.jsx)(u.B,{errors:S,name:"password",render:e=>{let{message:t}=e;return(0,n.jsx)("p",{className:"text-red-500 text-sm font-semibold",children:t})}}),(0,n.jsx)(o.A,{isLoading:e,type:"submit",className:"w-full",color:"secondary",children:"Login"})]}),(0,n.jsxs)("p",{className:"text-sm text-center",children:["Not a member yet?"," ",(0,n.jsx)(a(),{className:"underline text-blue-600",href:"/register",children:"Sign up"})," ","here"]})]})};function Login(){return(0,n.jsx)("section",{className:"w-full h-[100vh] pt-24 ",children:(0,n.jsx)(components_LoginForm,{})})}},4543:function(e,t,r){"use strict";r.d(t,{H:function(){return AuthContextProvider},V:function(){return o}});var n=r(7437),s=r(2265);let o=(0,s.createContext)(null),AuthContextProvider=e=>{let{children:t}=e,[r,l]=(0,s.useState)(!1),[a,i]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("email");l(!!e),i(t)},[r]),(0,s.useEffect)(()=>{console.log(a)},[a]),(0,n.jsx)(o.Provider,{value:{isAuthenticated:r,userEmail:a,handleLogin:(e,t)=>{console.log("email:",e),l(!0),localStorage.setItem("token",t),localStorage.setItem("email",e),i(e)},handleLogout:()=>{l(!1),localStorage.removeItem("token"),localStorage.removeItem("email"),i(null)}},children:t})}},1349:function(e,t,r){"use strict";r.d(t,{a:function(){return useAuth}});var n=r(4543),s=r(2265);let useAuth=()=>{let e=(0,s.useContext)(n.V);if(!e)throw Error("Failed to use AuthContext");return e}}},function(e){e.O(0,[745,534,396,633,674,971,864,744],function(){return e(e.s=3089)}),_N_E=e.O()}]);